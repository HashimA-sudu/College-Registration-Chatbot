<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Admin — Login</title>
  <link rel="stylesheet" href="assets/css/admin.css">
</head>
<body>
  <main class="container">
    <section class="card narrow">
      <h1 class="center">Admin Login</h1>
      <form id="loginForm" class="stack">
        <label>Email
          <input id="email" type="email" placeholder="admin@example.com" required>
        </label>
        <label>Password
          <input id="password" type="password" placeholder="••••••••" required>
        </label>
        <button class="btn" type="submit">Sign in</button>
        <p id="msg" class="muted center"></p>
      </form>
    </section>
  </main>

  <script>
    const API = localStorage.getItem("API_BASE") || "http://localhost:5000";
    document.getElementById("loginForm").addEventListener("submit", async (e)=>{
      e.preventDefault();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      const btn = e.target.querySelector("button");
      btn.disabled = true;
      try{
        const res = await fetch(API + "/api/auth/login", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          credentials:"include", // عشان الكوكي HTTP-Only
          body: JSON.stringify({ email, password })
        });
        const data = await res.json().catch(()=>({}));
        if(res.ok){
          location.href = "dashboard.html";
        }else{
          document.getElementById("msg").textContent = data.error || "Login failed";
        }
      }catch(_){
        document.getElementById("msg").textContent = "Network error";
      }finally{ btn.disabled = false; }
    });
  </script>
</body>
</html>
